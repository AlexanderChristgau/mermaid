

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Utilities &mdash; mermaid 0.1 documentation</title>
  

  
  
  
  

  

  
  
    

  

  
  
    <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  

  

  
        <link rel="index" title="Index"
              href="genindex.html"/>
        <link rel="search" title="Search" href="search.html"/>
    <link rel="top" title="mermaid 0.1 documentation" href="index.html"/>
        <link rel="next" title="Viewers" href="viewers.html"/>
        <link rel="prev" title="Spatial transforms" href="stn.html"/> 

  
  <script src="_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

   
  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="index.html" class="icon icon-home"> mermaid
          

          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Notes</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="notes/howto_own_registration.html">How to write your own registration model</a></li>
<li class="toctree-l1"><a class="reference internal" href="notes/installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="notes/parameters.html">Parameters</a></li>
<li class="toctree-l1"><a class="reference internal" href="notes/simple_example.html">Simple example</a></li>
<li class="toctree-l1"><a class="reference internal" href="notes/todos.html">TODOs</a></li>
</ul>
<p class="caption"><span class="caption-text">Package Reference</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="custom_optimizers.html">Custom optimizers</a></li>
<li class="toctree-l1"><a class="reference internal" href="custom_pytorch_extensions.html">Custom pyTorch extensions</a></li>
<li class="toctree-l1"><a class="reference internal" href="example_generation.html">Example generation</a></li>
<li class="toctree-l1"><a class="reference internal" href="finite_differences.html">Finite differences</a></li>
<li class="toctree-l1"><a class="reference internal" href="forward_models.html">Forward models</a></li>
<li class="toctree-l1"><a class="reference internal" href="image_sampling.html">Image sampling</a></li>
<li class="toctree-l1"><a class="reference internal" href="model_factory.html">Model factory</a></li>
<li class="toctree-l1"><a class="reference internal" href="module_parameters.html">Parameter module</a></li>
<li class="toctree-l1"><a class="reference internal" href="multiscale_optimizer.html">Multiscale optimizer</a></li>
<li class="toctree-l1"><a class="reference internal" href="registration_networks.html">Registration networks</a></li>
<li class="toctree-l1"><a class="reference internal" href="regularizer_factory.html">Regularizer factory</a></li>
<li class="toctree-l1"><a class="reference internal" href="rungekutta_integrators.html">Runge-Kutta integrators</a></li>
<li class="toctree-l1"><a class="reference internal" href="similarity_measure_factory.html">Similarity measure factory</a></li>
<li class="toctree-l1"><a class="reference internal" href="smoother_factory.html">Smoother factory</a></li>
<li class="toctree-l1"><a class="reference internal" href="stn.html">Spatial transforms</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Utilities</a></li>
<li class="toctree-l1"><a class="reference internal" href="viewers.html">Viewers</a></li>
<li class="toctree-l1"><a class="reference internal" href="visualize_registration_results.html">Visualize registration results</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">mermaid</a>
        
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="index.html">Docs</a> &raquo;</li>
        
      <li>Utilities</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="_sources/utils.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="utilities">
<h1>Utilities<a class="headerlink" href="#utilities" title="Permalink to this headline">¶</a></h1>
<span class="target" id="module-utils"></span><p>Various utility functions.</p>
<div class="admonition-todo admonition" id="index-0">
<p class="first admonition-title">Todo</p>
<p class="last">Reorganize this package in a more meaningful way.</p>
</div>
<dl class="function">
<dt id="utils.transform_image_to_NC_image_format">
<code class="descclassname">utils.</code><code class="descname">transform_image_to_NC_image_format</code><span class="sig-paren">(</span><em>I</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/utils.html#transform_image_to_NC_image_format"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#utils.transform_image_to_NC_image_format" title="Permalink to this definition">¶</a></dt>
<dd><p>Takes an input image and returns it in the format which is typical for torch.
I.e., two dimensions are added (the first one for number of images and the second for the
number of channels). As were are dealing with individual single-channel intensity images here, these
dimensions will be 1x1</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>I</strong> – input image of size, sz</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">input image, reshaped to size [1,1] + sz</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="utils.compute_normalized_gaussian">
<code class="descclassname">utils.</code><code class="descname">compute_normalized_gaussian</code><span class="sig-paren">(</span><em>X</em>, <em>mu</em>, <em>sig</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/utils.html#compute_normalized_gaussian"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#utils.compute_normalized_gaussian" title="Permalink to this definition">¶</a></dt>
<dd><p>Computes a normalized Gaussian</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>X</strong> – map with coordinates at which to evaluate</li>
<li><strong>mu</strong> – array indicating the mean</li>
<li><strong>sig</strong> – array indicating the standard deviations for the different dimensions</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">normalized Gaussian</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="utils.compute_warped_image_multiNC">
<code class="descclassname">utils.</code><code class="descname">compute_warped_image_multiNC</code><span class="sig-paren">(</span><em>I0</em>, <em>phi</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/utils.html#compute_warped_image_multiNC"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#utils.compute_warped_image_multiNC" title="Permalink to this definition">¶</a></dt>
<dd><p>Warps image.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>I0</strong> – image to warp, image size BxCxXxYxZ</li>
<li><strong>phi</strong> – map for the warping, size BxdimxXxYxZ</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">returns the warped image of size BxCxXxYxZ</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="utils.compute_vector_momentum_from_scalar_momentum_multiNC">
<code class="descclassname">utils.</code><code class="descname">compute_vector_momentum_from_scalar_momentum_multiNC</code><span class="sig-paren">(</span><em>lam</em>, <em>I</em>, <em>sz</em>, <em>spacing</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/utils.html#compute_vector_momentum_from_scalar_momentum_multiNC"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#utils.compute_vector_momentum_from_scalar_momentum_multiNC" title="Permalink to this definition">¶</a></dt>
<dd><p>Computes the vector momentum from the scalar momentum: <span class="math">\(m=\lambda\nabla I\)</span></p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>lam</strong> – scalar momentum, BxCxXxYxZ</li>
<li><strong>I</strong> – image, BxCxXxYxZ</li>
<li><strong>sz</strong> – size of image</li>
<li><strong>spacing</strong> – spacing of image</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">returns the vector momentum</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="utils.compute_vector_momentum_from_scalar_momentum_multiC">
<code class="descclassname">utils.</code><code class="descname">compute_vector_momentum_from_scalar_momentum_multiC</code><span class="sig-paren">(</span><em>lam</em>, <em>I</em>, <em>sz</em>, <em>spacing</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/utils.html#compute_vector_momentum_from_scalar_momentum_multiC"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#utils.compute_vector_momentum_from_scalar_momentum_multiC" title="Permalink to this definition">¶</a></dt>
<dd><p>Computes the vector momentum from the scalar momentum: <span class="math">\(m=\lambda\nabla I\)</span></p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>lam</strong> – scalar momentum, CxXxYxZ</li>
<li><strong>I</strong> – image, CxXxYxZ</li>
<li><strong>sz</strong> – size of image</li>
<li><strong>spacing</strong> – spacing of image</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">returns the vector momentum</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="utils.compute_vector_momentum_from_scalar_momentum_singleC">
<code class="descclassname">utils.</code><code class="descname">compute_vector_momentum_from_scalar_momentum_singleC</code><span class="sig-paren">(</span><em>lam</em>, <em>I</em>, <em>sz</em>, <em>spacing</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/utils.html#compute_vector_momentum_from_scalar_momentum_singleC"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#utils.compute_vector_momentum_from_scalar_momentum_singleC" title="Permalink to this definition">¶</a></dt>
<dd><p>Computes the vector momentum from the scalar momentum: <span class="math">\(m=\lambda\nabla I\)</span></p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>lam</strong> – scalar momentum, XxYxZ</li>
<li><strong>I</strong> – image, XxYxZ</li>
<li><strong>sz</strong> – size of image</li>
<li><strong>spacing</strong> – spacing of image</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">returns the vector momentum</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="utils.create_ND_vector_field_variable_multiN">
<code class="descclassname">utils.</code><code class="descname">create_ND_vector_field_variable_multiN</code><span class="sig-paren">(</span><em>sz</em>, <em>nrOfI=1</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/utils.html#create_ND_vector_field_variable_multiN"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#utils.create_ND_vector_field_variable_multiN" title="Permalink to this definition">¶</a></dt>
<dd><p>Create vector field torch Variable of given size</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>sz</strong> – just the spatial sizes (e.g., [5] in 1D, [5,10] in 2D, [5,10,10] in 3D)</li>
<li><strong>nrOfI</strong> – number of images</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">returns vector field of size nrOfIxdimxXxYxZ</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="utils.create_ND_vector_field_variable">
<code class="descclassname">utils.</code><code class="descname">create_ND_vector_field_variable</code><span class="sig-paren">(</span><em>sz</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/utils.html#create_ND_vector_field_variable"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#utils.create_ND_vector_field_variable" title="Permalink to this definition">¶</a></dt>
<dd><p>Create vector field torch Variable of given size</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>sz</strong> – just the spatial sizes (e.g., [5] in 1D, [5,10] in 2D, [5,10,10] in 3D)</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">returns vector field of size dimxXxYxZ</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="utils.create_ND_vector_field_parameter_multiN">
<code class="descclassname">utils.</code><code class="descname">create_ND_vector_field_parameter_multiN</code><span class="sig-paren">(</span><em>sz</em>, <em>nrOfI=1</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/utils.html#create_ND_vector_field_parameter_multiN"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#utils.create_ND_vector_field_parameter_multiN" title="Permalink to this definition">¶</a></dt>
<dd><p>Create vector field torch Parameter of given size</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>sz</strong> – just the spatial sizes (e.g., [5] in 1D, [5,10] in 2D, [5,10,10] in 3D)</li>
<li><strong>nrOfI</strong> – number of images</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">returns vector field of size nrOfIxdimxXxYxZ</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="utils.create_ND_scalar_field_parameter_multiNC">
<code class="descclassname">utils.</code><code class="descname">create_ND_scalar_field_parameter_multiNC</code><span class="sig-paren">(</span><em>sz</em>, <em>nrOfI=1</em>, <em>nrOfC=1</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/utils.html#create_ND_scalar_field_parameter_multiNC"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#utils.create_ND_scalar_field_parameter_multiNC" title="Permalink to this definition">¶</a></dt>
<dd><p>Create vector field torch Parameter of given size</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>sz</strong> – just the spatial sizes (e.g., [5] in 1D, [5,10] in 2D, [5,10,10] in 3D)</li>
<li><strong>nrOfI</strong> – number of images</li>
<li><strong>nrOfC</strong> – number of channels</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">returns vector field of size nrOfIxnrOfCxXxYxZ</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="utils.identity_map_multiN">
<code class="descclassname">utils.</code><code class="descname">identity_map_multiN</code><span class="sig-paren">(</span><em>sz</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/utils.html#identity_map_multiN"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#utils.identity_map_multiN" title="Permalink to this definition">¶</a></dt>
<dd><p>Create an identity map</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>sz</strong> – size of an image in BxCxXxYxZ format</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">returns the identity map</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="utils.identity_map">
<code class="descclassname">utils.</code><code class="descname">identity_map</code><span class="sig-paren">(</span><em>sz</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/utils.html#identity_map"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#utils.identity_map" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns an identity map.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>sz</strong> – just the spatial dimensions, i.e., XxYxZ</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">returns the identity map of dimension dimxXxYxZ</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="utils.t2np">
<code class="descclassname">utils.</code><code class="descname">t2np</code><span class="sig-paren">(</span><em>v</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/utils.html#t2np"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#utils.t2np" title="Permalink to this definition">¶</a></dt>
<dd><p>Takes a torch array and returns it as a numpy array on the cpu</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>v</strong> – torch array</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">numpy array</td>
</tr>
</tbody>
</table>
</dd></dl>

</div>


           </div>
           <div class="articleComments">
            
           </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="viewers.html" class="btn btn-neutral float-right" title="Viewers" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="stn.html" class="btn btn-neutral" title="Spatial transforms" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2017, Marc Niethammer.

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'./',
            VERSION:'0.1',
            LANGUAGE:'None',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true,
            SOURCELINK_SUFFIX: '.txt'
        };
    </script>
      <script type="text/javascript" src="_static/jquery.js"></script>
      <script type="text/javascript" src="_static/underscore.js"></script>
      <script type="text/javascript" src="_static/doctools.js"></script>
      <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>

  

  
  
    <script type="text/javascript" src="_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
   

</body>
</html>